@namespace WearWare.Components.Forms

@using System

<div class="mw-matrix-form-row">
    @if (ShowEnableToggle)
    {
        <InputCheckbox class="me-2" @bind-Value="EnabledChecked" />
    }
    <label class="mw-matrix-label">@Label</label>
    <CascadingValue Value="EnabledChecked">
        @ChildContent
    </CascadingValue>
</div>

@code {
    [Parameter] public string Label { get; set; } = string.Empty;
    [Parameter] public bool ShowEnableToggle { get; set; }

    [Parameter] public RenderFragment? ChildContent { get; set; }

    [Parameter] public Func<bool?>? VisibilityGetter { get; set; }
    [Parameter] public Action<bool?>? VisibilitySetter { get; set; }

    private bool EnabledChecked
    {
        get => VisibilityGetter == null ? true : (VisibilityGetter() ?? false);
        set
        {
            VisibilitySetter?.Invoke(value ? (bool?)true : null);
            // request UI update
            StateHasChanged();
        }
    }
}
